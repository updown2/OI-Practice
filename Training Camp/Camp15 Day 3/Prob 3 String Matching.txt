#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
#define For(i, a, b) for(int i=a; i<b; i++)
#define ffi For(i, 0, N)
#define ffj For(j, 0, M)
#define ffa ffi ffj
#define s <<" "<<
#define w cout
#define e "\n"
#define pb push_back
#define mp make_pair
#define a first
#define b second
#define int ll
const int MAXN=1000000, INF=1000000000, MAXX=200001;
///500,000,000
int T, N, M, cnt1, cnt2;
string a, b;
int goTo[MAXN];

main() {
	//ifstream cin ("test.in");
	ios_base::sync_with_stdio(0); cin.tie(0);

    cin >> T >> b >> a;
    N = a.length();
    M = b.length();

    int j = 0;
    goTo[0] = 0;
    For (i, 1, M) {
        j = goTo[i-1];
        while (true) {
            if (b[i] == b[j]) {
                goTo[i] = j+1;
                break;
            }
            if (j == 0) {
                goTo[i] = 0;
                break;
            }
            j = goTo[j-1];
        }
    }
    //ffj w<<goTo[j]<<e;
    j=0;
    ffi {
        while ( (j != 0 && a[i] != b[j]) || j==M ) j = goTo[j-1];

        if (a[i] == b[j]) j++;

        if (j == M) cnt1++;
    }
    a += a; N = a.length();
    j=0;
    ffi {
        while ( (j != 0 && a[i] != b[j]) || j==M ) j = goTo[j-1];

        if (a[i] == b[j]) j++;

        if (j == M) cnt2++;
    }
    //w<< cnt1 s cnt2<<e;
    cnt2 -= 2*cnt1;
    w<< T*cnt1 + (T-1)*cnt2<<e;
}