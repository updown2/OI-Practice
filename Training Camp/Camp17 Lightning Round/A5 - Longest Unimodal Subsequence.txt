#include <bits/stdc++.h>
using namespace std;
typedef long long ll;
#define For(i, a, b) for(ll i=a; i<b; i++)
#define ffi For(i, 0, N)
#define ffj For(j, 0, M)
#define s <<" "<<
#define w cout
#define e endl
#define pb push_back
#define mp make_pair
#define a first
#define b second
//500,000,000 operations
 
//Global Variables
ll N;
ll inp[100000];
ll len1[100001]; //len[length] = min biggest element value
ll len2[100001];
ll ss1[100000];
ll ss2[100000];
ll big;
ll small;
 
ll sear1(ll val) {
    ll small = 0;
    ll big = N;
    while (small != big) {
        ll mid = (small+big+1)/2;
        if (len1[mid] < val) small = mid;
        else big = mid-1;
    }
    return small+1;
}
ll sear2(ll val) {
    ll small = 0;
    ll big = N;
    while (small != big) {
        ll mid = (small+big+1)/2;
        if (len2[mid] < val) small = mid;
        else big = mid-1;
    }
    return small+1;
}
 
 
int main() {
	//ifstream cin ("test.in");
 
	cin >> N;
	cin >> inp[0];
	big = small = inp[0];
	For (i, 1, N) {
        cin >> inp[i];
        big = max(big, inp[i]);
        small = min(small, inp[i]);
    }
    For (i, 0, N+1) len1[i] = big+1;
    len1[0] = small-1;
 
	ffi {
	//For (j, 0, N) w<< len[j]<< " "; w<<e;
		ll use = sear1(inp[i]);
		len1[use] = min(len1[use], inp[i]);
		ss1[i] = use;
	}
 
	For (i, 0, N/2) swap(inp[i], inp[N-i-1]);
	For (i, 0, N+1) len2[i] = big+1;
    len2[0] = small-1;
 
	ffi {
	//For (j, 0, N) w<< len[j]<< " "; w<<e;
		ll use = sear2(inp[i]);
		len2[use] = min(len2[use], inp[i]);
		ss2[i] = use;
	}
	ll out = 0;
    ffi {
        //w<< ss1[i] s ss2[N-1-i]<<e;
        out = max(out, ss1[i]+ss2[N-1-i]-1);
    }
    w<<out<<e;
}